<?php

$spamtraps = array(
	'101.0.120.34',
	'103.18.109.240',
	'103.18.109.250',
	'103.252.152.36',
	'104.145.225.170',
	'104.145.231.123',
	'104.250.120.6',
	'104.250.125.14',
	'107.77.169.3',
	'107.77.169.6',
	'107.77.169.7',
	'107.77.169.9',
	'108.163.201.226',
	'108.163.220.50',
	'108.163.228.170',
	'108.178.0.170',
	'108.59.13.7',
	'109.70.46.52',
	'109.70.46.60',
	'109.71.47.152',
	'109.73.114.124',
	'109.73.114.185',
	'109.73.121.46',
	'109.73.121.78',
	'109.73.127.119',
	'119.18.40.41',
	'12.11.215.22',
	'12.228.145.130',
	'121.42.0.54',
	'121.42.0.55',
	'121.42.0.56',
	'121.42.0.57',
	'121.42.0.58',
	'121.42.0.59',
	'121.42.0.60',
	'121.42.0.61',
	'121.42.0.62',
	'121.42.0.63',
	'121.42.0.64',
	'121.42.0.65',
	'121.42.0.66',
	'121.42.0.67',
	'121.42.0.71',
	'121.42.0.73',
	'130.185.151.166',
	'154.66.196.240',
	'162.244.253.254',
	'162.254.116.4',
	'173.212.61.107',
	'173.212.61.109',
	'173.225.119.212',
	'174.142.192.213',
	'174.142.75.200',
	'174.71.247.228',
	'178.33.199.66',
	'178.33.199.69',
	'184.154.177.50',
	'184.154.208.34',
	'184.154.48.170',
	'184.154.58.226',
	'184.173.211.16',
	'184.173.211.17',
	'184.173.211.18',
	'184.173.211.19',
	'184.173.226.128',
	'184.173.226.129',
	'184.173.226.130',
	'184.173.226.131',
	'184.173.227.140',
	'184.173.227.141',
	'184.173.227.142',
	'184.173.227.143',
	'185.35.56.200',
	'185.35.57.200',
	'185.35.58.200',
	'185.35.59.200',
	'185.54.160.5',
	'185.77.66.226',
	'188.191.154.32',
	'188.191.156.2',
	'188.64.186.7',
	'190.105.226.105',
	'193.227.247.45',
	'193.238.80.45',
	'193.36.43.167',
	'194.110.243.232',
	'194.12.14.165',
	'194.145.240.225',
	'194.145.241.225',
	'194.145.241.227',
	'195.170.173.4',
	'195.216.197.8',
	'197.231.221.211',
	'197.242.157.101',
	'197.242.158.101',
	'197.242.159.36',
	'198.252.106.34',
	'198.77.227.16',
	'199.101.208.4',
	'199.116.169.254',
	'199.19.249.196',
	'199.193.181.24',
	'199.201.110.146',
	'199.201.110.154',
	'199.201.110.158',
	'199.96.156.50',
	'199.96.156.52',
	'202.124.241.65',
	'202.124.241.72',
	'202.124.241.73',
	'202.124.241.74',
	'202.124.241.75',
	'202.124.241.76',
	'202.130.44.227',
	'202.130.45.2',
	'202.130.45.7',
	'204.109.57.196',
	'204.109.63.9',
	'206.123.73.136',
	'207.158.10.26',
	'207.158.10.27',
	'207.158.10.28',
	'207.210.220.219',
	'207.46.13.84',
	'208.43.240.3',
	'208.79.26.61',
	'208.80.192.33',
	'208.80.194.120',
	'208.80.194.121',
	'208.80.194.122',
	'208.80.194.123',
	'208.80.194.124',
	'208.80.194.125',
	'208.80.194.126',
	'208.80.194.26',
	'208.80.194.27',
	'208.80.194.29',
	'208.80.194.30',
	'208.81.237.150',
	'209.188.18.54',
	'209.66.70.253',
	'212.105.191.45',
	'212.113.130.124',
	'212.113.147.38',
	'212.8.79.106',
	'213.5.180.28',
	'213.5.180.33',
	'216.116.192.44',
	'216.117.84.200',
	'216.135.85.218',
	'216.144.202.161',
	'216.144.202.162',
	'216.15.147.11',
	'216.151.4.120',
	'216.151.5.5',
	'216.86.146.40',
	'221.121.128.10',
	'24.214.181.250',
	'31.193.134.76',
	'37.191.115.200',
	'38.100.21.84',
	'38.100.21.86',
	'38.100.21.87',
	'38.101.213.200',
	'38.101.213.206',
	'5.135.53.210',
	'5.77.60.38',
	'50.115.17.101',
	'50.241.233.171',
	'50.77.231.18',
	'52.34.247.81',
	'52.53.247.219',
	'52.53.251.90',
	'52.7.243.144',
	'52.71.155.178',
	'54.153.127.36',
	'54.153.57.18',
	'54.153.66.117',
	'54.153.84.31',
	'54.153.9.80',
	'54.172.41.91',
	'54.183.135.144',
	'54.183.186.117',
	'54.183.214.0',
	'54.183.216.155',
	'54.183.220.180',
	'54.183.230.251',
	'54.183.236.74',
	'54.183.252.189',
	'54.183.4.170',
	'54.183.56.7',
	'54.193.29.61',
	'54.193.42.63',
	'54.193.52.76',
	'54.193.66.181',
	'54.219.131.203',
	'54.236.175.227',
	'54.67.101.83',
	'54.67.70.210',
	'54.67.70.55',
	'62.24.196.100',
	'62.24.222.131',
	'62.24.222.132',
	'62.24.252.133',
	'64.233.172.148',
	'64.233.172.156',
	'64.233.172.164',
	'64.233.172.218',
	'64.233.172.226',
	'64.233.172.234',
	'64.38.116.99',
	'64.74.215.1',
	'64.74.215.138',
	'64.74.215.139',
	'64.74.215.142',
	'64.74.215.146',
	'64.74.215.150',
	'64.74.215.154',
	'64.74.215.158',
	'64.74.215.162',
	'64.74.215.164',
	'64.74.215.166',
	'64.74.215.170',
	'64.74.215.174',
	'64.74.215.176',
	'64.74.215.178',
	'64.74.215.58',
	'64.74.215.59',
	'64.74.215.98',
	'65.99.202.136',
	'65.99.209.7',
	'66.102.8.227',
	'66.102.8.232',
	'66.102.8.237',
	'66.185.17.54',
	'66.185.17.56',
	'66.185.17.58',
	'66.249.80.66',
	'66.249.80.74',
	'66.249.80.82',
	'66.249.83.106',
	'66.249.83.108',
	'66.249.83.110',
	'66.249.84.79',
	'66.249.84.80',
	'66.249.84.81',
	'67.202.100.15',
	'67.22.138.176',
	'69.146.120.114',
	'69.160.33.88',
	'69.161.114.61',
	'69.175.33.179',
	'69.175.69.90',
	'69.36.161.91',
	'69.36.161.92',
	'69.64.15.250',
	'69.73.180.225',
	'69.73.180.226',
	'69.73.180.234',
	'69.89.2.72',
	'69.89.2.76',
	'69.89.2.79',
	'69.89.32.39',
	'69.89.32.40',
	'69.89.67.34',
	'70.42.131.106',
	'72.249.109.68',
	'72.249.150.158',
	'72.249.63.136',
	'74.217.90.250',
	'75.145.235.42',
	'76.246.2.194',
	'77.72.0.28',
	'77.72.0.30',
	'8.28.16.254',
	'80.40.134.103',
	'80.40.134.104',
	'80.65.249.30',
	'80.65.250.33',
	'80.65.252.229',
	'80.87.128.8',
	'80.87.129.209',
	'80.88.202.62',
	'80.88.212.174',
	'81.168.51.147',
	'81.17.241.167',
	'81.19.181.98',
	'81.27.110.50',
	'81.27.85.244',
	'81.29.83.162',
	'82.221.110.2',
	'84.39.115.54',
	'87.246.119.124',
	'88.150.159.16',
	'89.238.188.193',
	'89.238.188.194',
	'89.248.60.7',
	'89.248.61.6',
	'89.248.61.7',
	'91.121.160.100',
	'91.197.228.101',
	'95.172.255.45',
	'95.172.8.226',
	'96.125.182.176',
	'96.127.176.250',
	'96.127.190.2',
	'97.79.244.154',
	'98.143.158.170',
	'80.65.250.30',
	'72.5.231.11',
	'62.24.181.135',
	'198.186.192.46',
	'71.8.249.7',
	'64.235.154.105',
	'62.24.181.134',
);

foreach ($spamtraps as $spamtrap) {

	// 12.11.215.22: 22.215.11.12.in-addr.arpa domain name pointer mail.wisvis.com.
	// 12.228.145.130: Host 130.145.228.12.in-addr.arpa. not found: 3(NXDOMAIN)

	preg_match('/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).in-addr.arpa.?\s(domain name pointer)?\s?(.*)/im', `host $spamtrap`, $matches);

	if (preg_match('/NXDOMAIN/', $matches[3])) {
		//printf("%s: %s\n", $spamtrap, $matches[3]);
		printf("select * from (select * from ip_address_data where ip_to > INET_ATON('%s') limit 1) asdf union \n", $spamtrap);

	}
}
