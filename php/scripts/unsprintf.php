<?php

$string = <<<EOS

SELECT\n\towners.owner,\n    owner_lists.owner_list_id,\n    owner_lists.owner_list,\n\tmanagers.manager,\n    manager_lists.manager_list,\n    manager_lists.manager_list_id,\n    list_categories.list_category,\n    last_revenue.revenue AS prev_report_revenue,\n    prev_report_manager_post_count_by_date.gross_count AS prev_report_gross,\n    current_revenue.revenue AS current_report_revenue,\n    current_report_manager_post_count_by_date.gross_count AS current_report_gross\nFROM (select owner_list_id,manager_list_id FROM olap.report_manager_post_count_by_date  where report_date > now() - interval 6 month\nUNION\nSELECT owner_list_id,manager_list_id  from manager_list_revenue where report_date > now() - interval 6 month) as all_combos\n\n-- OWNER LISTS\nINNER JOIN owner_lists using(owner_list_id)\n\n-- MANGER LISTS\njoin manager_lists using(manager_list_id)\n\n-- List Categories\nINNER JOIN list_categories ON manager_lists.list_category_id=list_categories.list_category_id\n\n-- MANAGER REVNUE LAST MONTH\nLEFT JOIN (\n\tSELECT\n\t\tmanager_list_id,\n        owner_list_id,\n        revenue\n\tFROM manager_list_revenue\n    WHERE month = 01 AND year = 2020\n)AS last_revenue\n\tON all_combos.manager_list_id=last_revenue.manager_list_id\n\tAND all_combos.owner_list_id=last_revenue.owner_list_id\n\n\n-- MANAGER REVENUE CURRENT MONTH\nLEFT JOIN (\n\tSELECT\n\t\tmanager_list_id,\n        owner_list_id,\n        revenue\n\tFROM manager_list_revenue\n    WHERE month = 2 AND year = 2020\n)AS current_revenue\n\tON all_combos.manager_list_id=current_revenue.manager_list_id\n\tAND all_combos.owner_list_id=current_revenue.owner_list_id\n\n-- MANAGER POST FROM THIS OWNER LIST LAST MONTH\nLEFT JOIN (\n\tSELECT\n\t\towner_list_id,\n        manager_list_id,\n\t\tsum(gross_count) AS gross_count\n\tFROM olap.report_manager_post_count_by_date\n    WHERE olap.report_manager_post_count_by_date.status_id IN ( 4, 7)\n\t\tAND report_date BETWEEN first_day(Str_to_date('2/15/2020', '%m/%d/%Y') - INTERVAL 1 MONTH )\n        AND last_day(Str_to_date('2/15/2020', '%m/%d/%Y') - INTERVAL 1 MONTH )\n\tGROUP BY owner_list_id, manager_list_id) AS prev_report_manager_post_count_by_date\n\tON owner_lists.owner_list_id = prev_report_manager_post_count_by_date.owner_list_id\n\tAND manager_lists.manager_list_id = prev_report_manager_post_count_by_date.manager_list_id\n\n-- MANAGER POSTS FOR THIS OWNER LIST CURRENT MONTH\nLEFT JOIN (\n\tSELECT\n\t\towner_list_id,\n\t\tmanager_list_id,\n        sum(gross_count) AS gross_count\n\tFROM olap.report_manager_post_count_by_date\n    WHERE olap.report_manager_post_count_by_date.status_id IN ( 4, 7)\n\t\tAND  report_date BETWEEN first_day(Str_to_date('2/15/2020', '%m/%d/%Y') )\n        AND last_day(Str_to_date('2/15/2020', '%m/%d/%Y') )\n\tGROUP BY owner_list_id, manager_list_id) AS current_report_manager_post_count_by_date\n\tON owner_lists.owner_list_id = current_report_manager_post_count_by_date.owner_list_id\n\tAND manager_lists.manager_list_id = current_report_manager_post_count_by_date.manager_list_id\n\n-- MANGERS\nINNER JOIN managers USING(manager_id)\n\n-- OWNERS\nINNER JOIN owners ON owner_lists.owner_id = owners.owner_id\n\nWHERE owner_lists.owner_list_id <> 200
EOS;

printf("%s",$string);
